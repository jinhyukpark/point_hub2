<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
    <meta name="format-detection" content="telephone=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#231F20">
    <meta name="screen-orientation" content="portrait">
    <meta name="orientation" content="portrait">
    <title>PointHub - Fantasy Studio</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body, html {
            height: 100vh;
            overflow: hidden;
            font-family: 'Merriweather', serif;
            margin: 0;
            padding: 0;
        }

        @import url('https://fonts.googleapis.com/css2?family=Merriweather:wght@300;400;700;900&display=swap');

        /* Unity Canvas Scaler: Match Width or Height = Height, Reference Resolution = 1080x2160 */
        :root {
            --scale-factor: calc(100vh / 2160px);
            --popup-width: calc(800px * var(--scale-factor));
            --popup-height: calc(1000px * var(--scale-factor));
            --input-width: calc(650px * var(--scale-factor));
            --input-height: calc(175px * var(--scale-factor));
            --button-width: calc(518px * var(--scale-factor));
            --button-height: calc(145px * var(--scale-factor));
        }

        /* Unity Canvas - Base Layer */
        #unity-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 1;
            background: #231F20;
            pointer-events: none; /* Disabled by default to allow auth interaction */
        }
        
        /* Hide Unity when auth is visible */
        body:not(.authenticated) #unity-canvas {
            visibility: hidden;
        }
        
        /* Enable Unity interactions when authenticated */
        body.authenticated #unity-canvas {
            pointer-events: auto;
            visibility: visible;
        }

        /* Background for Auth Pages */
        .background-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: url('./img/bg.png') no-repeat center center;
            background-size: cover;
            background-attachment: fixed;
            z-index: 500;
            display: block; /* Í∏∞Î≥∏Ï†ÅÏúºÎ°ú ÌëúÏãú */
        }
        
        /* Ïù∏Ï¶ùÏù¥ ÏôÑÎ£åÎêòÎ©¥ Î∞∞Í≤Ω ÏôÑÏ†ÑÌûà Ïà®ÍπÄ */
        body.authenticated .background-container {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
            pointer-events: none !important;
        }

        /* Logo - Always Top Layer */
        .logo {
            position: fixed;
            left: calc(50% + (-490px * var(--scale-factor)));
            top: calc(0% + (125px * var(--scale-factor)));
            width: calc(400px * var(--scale-factor));
            height: auto;
            z-index: 9999;
        }

        /* Authentication Container */
        .auth-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        /* Ïù∏Ï¶ùÏù¥ ÏôÑÎ£åÎêòÎ©¥ auth container ÏôÑÏ†ÑÌûà Ïà®ÍπÄ */
        body.authenticated .auth-container {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
            pointer-events: none !important;
        }

        /* Login/Signup Popup Styles */
        .auth-popup {
            /* 9-slice border-image: ÏÉÅ Ïö∞ Ìïò Ï¢å ÏàúÏÑúÎ°ú slice Í∞í ÏßÄÏ†ï */
            border-image-source: url('./img/login_popup_bg.png');
            border-image-slice: 50 50 50 50 fill;
            border-image-width: calc(50px * var(--scale-factor));
            border-image-outset: 0;
            border-image-repeat: stretch stretch;
            background: transparent;
            width: var(--popup-width);
            height: var(--popup-height);
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: calc(100px * var(--scale-factor)) calc(75px * var(--scale-factor));
            box-sizing: border-box;
        }

        .auth-popup.signup {
            height: calc(1200px * var(--scale-factor));
            padding: calc(80px * var(--scale-factor)) calc(75px * var(--scale-factor));
        }

        .auth-title {
            color: #ffffff;
            font-size: calc(60px * var(--scale-factor));
            font-weight: bold;
            margin-bottom: calc(60px * var(--scale-factor));
            text-align: center;
            text-shadow: calc(2px * var(--scale-factor)) calc(2px * var(--scale-factor)) calc(4px * var(--scale-factor)) rgba(0,0,0,0.5);
            letter-spacing: calc(4px * var(--scale-factor));
        }

        .input-container {
            position: relative;
            margin-bottom: calc(40px * var(--scale-factor));
            width: var(--input-width);
            height: var(--input-height);
        }

        .input-container.signup {
            margin-bottom: calc(30px * var(--scale-factor));
        }

        .input-label {
            position: absolute;
            top: calc(40px * var(--scale-factor));
            left: calc(50px * var(--scale-factor));
            color: rgba(255, 255, 255, 0.5);
            font-size: calc(24px * var(--scale-factor));
            font-weight: 400;
            text-shadow: calc(1px * var(--scale-factor)) calc(1px * var(--scale-factor)) calc(2px * var(--scale-factor)) rgba(0,0,0,0.5);
            letter-spacing: calc(1px * var(--scale-factor));
            z-index: 2;
            pointer-events: none;
        }

        .input-field {
            width: var(--input-width);
            height: var(--input-height);
            /* 9-slice border-image: ÏÉÅ Ïö∞ Ìïò Ï¢å ÏàúÏÑúÎ°ú slice Í∞í ÏßÄÏ†ï */
            border-image-source: url('./img/UI_Email.png');
            border-image-slice: 25 25 25 25 fill;
            border-image-width: calc(25px * var(--scale-factor));
            border-image-outset: 0;
            border-image-repeat: stretch stretch;
            background: transparent;
            color: #ffffff;
            font-size: calc(44px * var(--scale-factor));
            padding: calc(80px * var(--scale-factor)) calc(40px * var(--scale-factor)) calc(40px * var(--scale-factor)) calc(40px * var(--scale-factor));
            outline: none;
            font-family: 'Merriweather', serif;
            transition: filter 0.3s ease;
            box-sizing: border-box;
        }

        .input-field.password {
            border-image-source: url('./img/UI_Password.png');
            border-image-slice: 25 25 25 25 fill;
            border-image-width: calc(25px * var(--scale-factor));
            border-image-outset: 0;
            border-image-repeat: stretch stretch;
        }

        .input-field:focus {
            filter: brightness(1.2) drop-shadow(0 0 calc(10px * var(--scale-factor)) rgba(139, 92, 246, 0.5));
        }

        .input-field.password:focus {
            filter: brightness(1.2) drop-shadow(0 0 calc(10px * var(--scale-factor)) rgba(6, 182, 212, 0.5));
        }

        /* Browser autofill override */
        .input-field:-webkit-autofill,
        .input-field:-webkit-autofill:hover,
        .input-field:-webkit-autofill:focus,
        .input-field:-webkit-autofill:active {
            -webkit-box-shadow: 0 0 0 1000px transparent inset !important;
            -webkit-text-fill-color: #ffffff !important;
            background: transparent !important;
            transition: background-color 5000s ease-in-out 0s;
        }

        .auth-button {
            /* 9-slice border-image: ÏÉÅ Ïö∞ Ìïò Ï¢å ÏàúÏÑúÎ°ú slice Í∞í ÏßÄÏ†ï */
            border-image-source: url('./img/login_button.png');
            border-image-slice: 30 30 30 30 fill;
            border-image-width: calc(30px * var(--scale-factor));
            border-image-outset: 0;
            border-image-repeat: stretch stretch;
            background: transparent;
            width: var(--button-width);
            height: var(--button-height);
            cursor: pointer;
            color: #ffffff;
            font-size: calc(32px * var(--scale-factor));
            font-weight: bold;
            text-shadow: calc(1px * var(--scale-factor)) calc(1px * var(--scale-factor)) calc(2px * var(--scale-factor)) rgba(0,0,0,0.5);
            margin-top: calc(40px * var(--scale-factor));
            transition: transform 0.2s ease, filter 0.2s ease;
            box-sizing: border-box;
        }

        .auth-button.signup {
            margin-top: calc(30px * var(--scale-factor));
            border-image-source: url('./img/signup_button.png');
            border-image-slice: 30 30 30 30 fill;
            border-image-width: calc(30px * var(--scale-factor));
            border-image-outset: 0;
            border-image-repeat: stretch stretch;
            background: transparent;
        }

        .auth-button:hover {
            transform: scale(1.05);
            filter: brightness(1.1);
        }

        .auth-button:active {
            transform: scale(0.95);
        }

        .auth-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .error-message {
            color: #ff6b6b;
            font-size: calc(14px * var(--scale-factor));
            margin-top: calc(10px * var(--scale-factor));
            text-align: center;
            text-shadow: calc(1px * var(--scale-factor)) calc(1px * var(--scale-factor)) calc(2px * var(--scale-factor)) rgba(0,0,0,0.5);
        }

        .success-message {
            color: #4caf50;
            font-size: calc(14px * var(--scale-factor));
            margin-top: calc(10px * var(--scale-factor));
            text-align: center;
            text-shadow: calc(1px * var(--scale-factor)) calc(1px * var(--scale-factor)) calc(2px * var(--scale-factor)) rgba(0,0,0,0.5);
        }

        .loading {
            display: none;
            color: #66ccff;
            font-size: calc(14px * var(--scale-factor));
            margin-top: calc(10px * var(--scale-factor));
            text-align: center;
        }

        .nav-link {
            color: rgba(255, 255, 255, 0.5);
            font-size: calc(32px * var(--scale-factor));
            text-decoration: none;
            margin-top: calc(20px * var(--scale-factor));
            text-shadow: calc(1px * var(--scale-factor)) calc(1px * var(--scale-factor)) calc(2px * var(--scale-factor)) rgba(0,0,0,0.5);
            transition: color 0.3s ease;
            cursor: pointer;
        }

        .nav-link:hover {
            color: #66ccff;
            text-decoration: underline;
        }

        /* Loading overlay */
        .unity-loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: #231F20;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #ffffff;
            font-size: calc(24px * var(--scale-factor));
            z-index: 2;
        }

        /* Hide classes */
        .hidden {
            display: none !important;
        }

        .fade-out {
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .fade-in {
            opacity: 1;
            transition: opacity 0.5s ease;
        }
        
        /* Samsung Internet Browser specific fixes */
        .samsung-internet .auth-popup.hidden {
            display: none !important;
        }
        
        .samsung-internet .hidden {
            display: none !important;
        }
        
        /* Î°úÍ≥† ÌÅ¨Í∏∞ Ï°∞Ï†ï */
        .samsung-internet .logo {
            width: 18vw !important;
            max-width: 200px !important;
            min-width: 150px !important;
        }
        
        /* ÌåùÏóÖ ÌÅ¨Í∏∞ Ï°∞Ï†ï - vw/vh Îã®ÏúÑ ÏÇ¨Ïö© */
        .samsung-internet .auth-popup:not(.hidden) {
            width: 80vw !important;
            max-width: 450px !important;
            min-width: 320px !important;
            height: auto !important;
            min-height: 60vh !important;
            max-height: 85vh !important;
            padding: 8vh 5vw 6vh 5vw !important;
            border: none !important;
            background: url('./img/login_popup_bg.png') no-repeat center center !important;
            background-size: 100% 100% !important;
            display: flex !important;
            flex-direction: column !important;
            align-items: center !important;
            justify-content: center !important;
        }
        
        .samsung-internet .auth-popup.signup {
            min-height: 70vh !important;
            max-height: 90vh !important;
            padding: 6vh 5vw 5vh 5vw !important;
        }
        
        /* Ï†úÎ™© Ïä§ÌÉÄÏùº */
        .samsung-internet .auth-title {
            font-size: clamp(24px, 5vw, 32px) !important;
        }
        
        /* ÏûÖÎ†• ÌïÑÎìú Ïª®ÌÖåÏù¥ÎÑà */
        .samsung-internet .input-container {
            width: 85% !important;
            max-width: 400px !important;
            height: auto !important;
            min-height: 70px !important;
            margin-bottom: 25px !important;
        }
        
        .samsung-internet .input-container.signup {
            margin-bottom: 20px !important;
        }
        
        /* ÏûÖÎ†• ÌïÑÎìú ÎùºÎ≤® */
        .samsung-internet .input-label {
            top: 20px !important;
            left: 20px !important;
            font-size: 10px !important;
            color: rgba(255, 255, 255, 0.6) !important;
            font-weight: 400 !important;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5) !important;
            letter-spacing: 1px !important;
            z-index: 2 !important;
            pointer-events: none !important;
        }
        
        /* ÏûÖÎ†• ÌïÑÎìú - border-image ÎåÄÏã† background-image ÏÇ¨Ïö© */
        .samsung-internet .input-field {
            width: 100% !important;
            height: 70px !important;
            min-height: 70px !important;
            max-height: 80px !important;
            padding: 35px 20px 15px 20px !important;
            font-size: 18px !important;
            color: #ffffff !important;
            font-family: 'Merriweather', serif !important;
            border: none !important;
            background: url('./img/UI_Email.png') no-repeat center center !important;
            background-size: 100% 100% !important;
            box-sizing: border-box !important;
            -webkit-box-sizing: border-box !important;
            -moz-box-sizing: border-box !important;
        }
        
        .samsung-internet .input-field.password {
            background: url('./img/UI_Password.png') no-repeat center center !important;
            background-size: 100% 100% !important;
        }
        
        /* Î≤ÑÌäº */
        .samsung-internet .auth-button {
            width: 80% !important;
            max-width: 400px !important;
            min-width: 250px !important;
            height: calc(180px * var(--scale-factor)) !important;
            min-height: 60px !important;
            max-height: 80px !important;
            font-size: calc(32px * var(--scale-factor)) !important;
            margin-top: calc(40px * var(--scale-factor)) !important;
            border: none !important;
            background: url('./img/login_button.png') no-repeat center center !important;
            background-size: 100% 100% !important;
        }
        
        .samsung-internet .auth-button.signup {
            background: url('./img/signup_button.png') no-repeat center center !important;
            background-size: 100% 100% !important;
            margin-top: calc(30px * var(--scale-factor)) !important;
        }
        
        .samsung-internet .nav-link {
            font-size: calc(32px * var(--scale-factor)) !important;
        }
        
        .samsung-internet .error-message,
        .samsung-internet .success-message,
        .samsung-internet .loading {
            font-size: calc(14px * var(--scale-factor)) !important;
        }
        
        /* Chrome specific enhancements */
        .chrome-detected .auth-popup {
            border-image-source: url('./img/login_popup_bg.png');
            border-image-slice: 50 50 50 50 fill;
            border-image-width: calc(50px * var(--scale-factor));
            border-image-outset: 0;
            border-image-repeat: stretch stretch;
            background: transparent;
        }
        
        .chrome-detected .input-field {
            border-image-source: url('./img/UI_Email.png');
            border-image-slice: 25 25 25 25 fill;
            border-image-width: calc(25px * var(--scale-factor));
            border-image-outset: 0;
            border-image-repeat: stretch stretch;
            background: transparent;
        }
        
        .chrome-detected .input-field.password {
            border-image-source: url('./img/UI_Password.png');
            border-image-slice: 25 25 25 25 fill;
            border-image-width: calc(25px * var(--scale-factor));
            border-image-outset: 0;
            border-image-repeat: stretch stretch;
            background: transparent;
        }
        
        .chrome-detected .auth-button {
            border-image-source: url('./img/login_button.png');
            border-image-slice: 30 30 30 30 fill;
            border-image-width: calc(30px * var(--scale-factor));
            border-image-outset: 0;
            border-image-repeat: stretch stretch;
            background: transparent !important;
            min-width: 255px;
            min-height: 60px;
            font-size: calc(32px * var(--scale-factor));
        }
        
        .chrome-detected .auth-button.signup {
            border-image-source: url('./img/signup_button.png');
            border-image-slice: 30 30 30 30 fill;
            border-image-width: calc(30px * var(--scale-factor));
            border-image-outset: 0;
            border-image-repeat: stretch stretch;
            background: transparent !important;
        }
        
        /* Fallback for browsers that don't support border-image */
        @supports not (border-image: url() 50 fill) {
            .auth-popup:not(.chrome-detected):not(.samsung-internet) {
                border: none;
                background: url('./img/login_popup_bg.png') no-repeat center center;
                background-size: 100% 100%;
                width: 80vw;
                height: 70vh;
                max-width: 400px;
                max-height: 500px;
                min-width: 320px;
                min-height: 400px;
                padding: 60px 40px;
            }
        }
    </style>
    
    <!-- Firebase Configuration (loaded from .env) -->
    <script src="./firebase-config.js"></script>
    
    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js';
        import { getAuth, onAuthStateChanged, signInWithEmailAndPassword, createUserWithEmailAndPassword, signOut, connectAuthEmulator } from 'https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js';
        import { getDatabase, ref, onValue, onChildAdded, onChildChanged, off, get, set, update, connectDatabaseEmulator } from 'https://www.gstatic.com/firebasejs/10.7.0/firebase-database.js';
        import { getFunctions, httpsCallable, connectFunctionsEmulator } from 'https://www.gstatic.com/firebasejs/10.7.0/firebase-functions.js';
        
        // Firebase configuration (loaded from firebase-config.js)
        const firebaseConfig = window.firebaseConfig;
        
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const database = getDatabase(app);

        // Functions Ï¥àÍ∏∞Ìôî ÏãúÎèÑ (ÏóêÎü¨ Ï≤òÎ¶¨ Ìè¨Ìï®)
        let functions = null;
        try {
            functions = getFunctions(app);
            console.log('‚úÖ Firebase Functions initialized successfully');
        } catch (error) {
            console.error('‚ùå Firebase Functions initialization failed:', error);
        }

        // ÏóêÎÆ¨Î†àÏù¥ÌÑ∞ Ïó∞Í≤∞ (localhostÏóêÏÑúÎßå)
        if (location.hostname === 'localhost' || location.hostname === '127.0.0.1') {
            try {
                connectAuthEmulator(auth, "http://127.0.0.1:9099", { disableWarnings: true });
                console.log('‚úÖ Connected to Auth Emulator');
            } catch (e) {
                console.log('Auth emulator connection skipped:', e.message);
            }

            try {
                connectDatabaseEmulator(database, "127.0.0.1", 9000);
                console.log('‚úÖ Connected to Database Emulator');
            } catch (e) {
                console.log('Database emulator connection skipped:', e.message);
            }

            if (functions) {
                try {
                    connectFunctionsEmulator(functions, "127.0.0.1", 5001);
                    console.log('‚úÖ Connected to Functions Emulator');
                } catch (e) {
                    console.log('Functions emulator connection skipped:', e.message);
                }
            }

            console.log('üîß Running in LOCAL EMULATOR mode');
        } else {
            console.log('üåê Running in PRODUCTION mode');
        }
        
        // Make available globally
        window.firebaseAuth = auth;
        window.firebaseDatabase = database;
        window.firebaseFunctions = functions; // nullÏùº Ïàò ÏûàÏùå
        window.firebaseRef = ref;
        window.firebaseOnValue = onValue;
        window.firebaseOnChildAdded = onChildAdded;
        window.firebaseOnChildChanged = onChildChanged;
        window.firebaseOff = off;
        // Helper: onValueÎ•º PromiseÎ°ú Í∞êÏã∏ÏÑú Ìïú Î≤àÎßå ÏùΩÍ∏∞
        window.firebaseOnce = (dbRef) => {
            return new Promise((resolve, reject) => {
                let unsubscribe;
                unsubscribe = onValue(dbRef, (snapshot) => {
                    if (unsubscribe) unsubscribe(); // Ï¶âÏãú Ìï¥Ï†ú
                    resolve(snapshot);
                }, (error) => {
                    if (unsubscribe) unsubscribe();
                    reject(error);
                });
            });
        };
        window.firebaseSet = set;
        window.firebaseUpdate = update;
        window.httpsCallable = functions ? httpsCallable : null;
        window.signInWithEmailAndPassword = signInWithEmailAndPassword;
        window.createUserWithEmailAndPassword = createUserWithEmailAndPassword;
        window.signOut = signOut;
        window.onAuthStateChanged = onAuthStateChanged;
        
        // Î°úÍ∑∏ÏïÑÏõÉ Í∞êÏßÄ Î∞è ÌéòÏù¥ÏßÄ ÏÉàÎ°úÍ≥†Ïπ®
        let previousAuthState = null;
        onAuthStateChanged(auth, (user) => {
            // Ïù¥Ï†Ñ ÏÉÅÌÉúÍ∞Ä Î°úÍ∑∏Ïù∏ ÏÉÅÌÉúÏòÄÍ≥† ÌòÑÏû¨Îäî Î°úÍ∑∏ÏïÑÏõÉ ÏÉÅÌÉúÏù∏ Í≤ΩÏö∞
            if (previousAuthState !== null && previousAuthState && !user) {
                console.log('üîÑ Î°úÍ∑∏ÏïÑÏõÉ Í∞êÏßÄÎê®, ÌéòÏù¥ÏßÄ ÏÉàÎ°úÍ≥†Ïπ®...');
                setTimeout(() => {
                    window.location.reload();
                }, 100);
            }
            previousAuthState = !!user;
        });
        
        // ÌôîÎ©¥ Î∞©Ìñ• Í≥†Ï†ï (ÏÑ∏Î°ú Î™®Îìú Ïú†ÏßÄ)
        function lockOrientation() {
            // Screen Orientation API ÏÇ¨Ïö© (ÏßÄÏõêÎêòÎäî Í≤ΩÏö∞)
            if (screen.orientation && screen.orientation.lock) {
                screen.orientation.lock('portrait').catch((err) => {
                    console.log('ÌôîÎ©¥ Î∞©Ìñ• Ïû†Í∏à Ïã§Ìå® (ÏùºÎ∂Ä Î∏åÎùºÏö∞Ï†ÄÏóêÏÑúÎäî ÏßÄÏõêÎêòÏßÄ ÏïäÏùå):', err);
                });
            }
            // iOS SafariÎ•º ÏúÑÌïú ÎåÄÏ≤¥ Î∞©Î≤ï
            else if (screen.lockOrientation) {
                screen.lockOrientation('portrait');
            }
            else if (screen.mozLockOrientation) {
                screen.mozLockOrientation('portrait');
            }
            else if (screen.msLockOrientation) {
                screen.msLockOrientation('portrait');
            }
        }
        
        // ÌôîÎ©¥ Î∞©Ìñ• Î≥ÄÍ≤Ω Í∞êÏßÄ Î∞è Î∞©ÏßÄ
        function preventOrientationChange() {
            const handleOrientationChange = () => {
                if (window.orientation === 90 || window.orientation === -90) {
                    // Í∞ÄÎ°ú Î™®ÎìúÎ°ú Ï†ÑÌôò ÏãúÎèÑ Ïãú ÏÑ∏Î°ú Î™®ÎìúÎ°ú ÎêòÎèåÎ¶¨Í∏∞
                    if (screen.orientation && screen.orientation.lock) {
                        screen.orientation.lock('portrait').catch(() => {});
                    }
                }
            };
            
            // orientationchange Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà
            window.addEventListener('orientationchange', handleOrientationChange);
            
            // resize Ïù¥Î≤§Ìä∏Î°úÎèÑ Í∞êÏßÄ (ÏùºÎ∂Ä Î∏åÎùºÏö∞Ï†Ä)
            window.addEventListener('resize', () => {
                if (window.innerWidth > window.innerHeight) {
                    // Í∞ÄÎ°ú Î™®ÎìúÎ°ú Ï†ÑÌôòÎêú Í≤ΩÏö∞
                    handleOrientationChange();
                }
            });
        }
        
        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú ÌôîÎ©¥ Î∞©Ìñ• Í≥†Ï†ï
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                lockOrientation();
                preventOrientationChange();
            });
        } else {
            lockOrientation();
            preventOrientationChange();
        }
        
        // Firebase Ï¥àÍ∏∞Ìôî ÏôÑÎ£å ÌîåÎûòÍ∑∏ ÏÑ§Ï†ï
        window.firebaseReady = true;
        console.log('‚úÖ Firebase initialized and ready');
        console.log('firebaseRef available:', typeof window.firebaseRef);
        console.log('firebaseDatabase available:', typeof window.firebaseDatabase);
        console.log('üìä Using once() for one-time reads (get() is Admin SDK only)');
        
        // Firebase Ï¥àÍ∏∞Ìôî Ïù¥Î≤§Ìä∏ Î∞úÏÉù
        window.dispatchEvent(new CustomEvent('firebaseReady', {
            detail: { 
                firebaseRef: ref,
                firebaseDatabase: database,
                firebaseReady: true 
            }
        }));
        
        // app.jsÎ•º ÎèôÏ†ÅÏúºÎ°ú Î°úÎìú (ÏïΩÍ∞ÑÏùò ÏßÄÏó∞ ÌõÑ)
        setTimeout(() => {
            const appScript = document.createElement('script');
            appScript.src = 'app.js';
            appScript.onload = () => {
                console.log('‚úÖ app.js loaded after Firebase initialization');
            };
            document.head.appendChild(appScript);
        }, 100);
    </script>
</head>
<body>
    <!-- Unity Canvas - Base Layer (z-index: 1) -->
    <canvas id="unity-canvas"></canvas>
    
    <!-- Unity Loading Screen (z-index: 2) -->
    <div id="unity-loading" class="unity-loading">
        Loading Unity Game...
    </div>
    
    <!-- Background for Auth (z-index: 500) -->
    <div id="background-container" class="background-container"></div>
    
    <!-- Authentication Container (z-index: 1000) -->
    <div id="auth-container" class="auth-container">
        <!-- Login Form -->
        <div id="login-form" class="auth-popup">
            <h1 class="auth-title">LOGIN</h1>
            
            <div class="input-container">
                <label class="input-label" for="login-email">E-MAIL</label>
                <input type="email" id="login-email" class="input-field" required autocomplete="off" spellcheck="false">
            </div>
            
            <div class="input-container">
                <label class="input-label" for="login-password">PASSWORD</label>
                <input type="password" id="login-password" class="input-field password" required autocomplete="off" spellcheck="false">
            </div>
            
            <button type="button" id="login-btn" class="auth-button"></button>
            
            <div id="login-error" class="error-message"></div>
            <div id="login-loading" class="loading">Logging in...</div>
            
            <a id="show-signup" class="nav-link">Sign Up</a>
        </div>
        
        <!-- Signup Form -->
        <div id="signup-form" class="auth-popup signup hidden">
            <h1 class="auth-title">SIGN UP</h1>
            
            <div class="input-container signup">
                <label class="input-label" for="signup-email">E-MAIL</label>
                <input type="email" id="signup-email" class="input-field" required>
            </div>
            
            <div class="input-container signup">
                <label class="input-label" for="signup-password">PASSWORD</label>
                <input type="password" id="signup-password" class="input-field password" required>
            </div>
            
            <div class="input-container signup">
                <label class="input-label" for="signup-confirm">CONFIRM PASSWORD</label>
                <input type="password" id="signup-confirm" class="input-field password" required>
            </div>
            
            <button type="button" id="signup-btn" class="auth-button signup"></button>
            
            <div id="signup-error" class="error-message"></div>
            <div id="signup-success" class="success-message"></div>
            <div id="signup-loading" class="loading">Creating account...</div>
            
            <a id="show-login" class="nav-link">Already have an account? Login</a>
        </div>
    </div>
    
    <!-- Logo - Always Top (z-index: 9999) -->
    <img src="./img/logo.png" alt="FANTASY STUDIO" class="logo">

    <!-- Unity Loader -->
    <script src="Build/pointhub.loader.js"></script>
</body>
</html>
